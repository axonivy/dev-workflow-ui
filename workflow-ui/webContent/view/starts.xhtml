<html xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:ic="http://ivyteam.ch/jsf/component" xmlns:p="http://primefaces.org/ui"
  xmlns:pe="http://primefaces.org/ui/extensions">

<h:body>
  <ui:composition template="../includes/template/template.xhtml">
    <ui:define name="content">
      <h:form id="startsForm">
        <h:panelGroup styleClass="card card-w-title custom-card" layout="block">
          <h:outputText value="Starts" styleClass="card-header-title" />
          <p:panel styleClass="main-starts-container">
            <f:facet name="header">
              <p:outputPanel>
                <p:inputText id="filter" placeholder="Search project or start" value="#{processesBean.filter}">
                  <p:ajax event="keyup" update="projectStarts" />
                </p:inputText>
              </p:outputPanel>
            </f:facet>
            <p:accordionPanel var="pmv" value="#{processesBean.PMVs}" id="projectStarts" activeIndex="0" multiple="true">
              <p:tab titleStyleClass="straight-text-icon">
                <f:facet name="title">
                  <i class="si si-#{pmv.stateIcon}" title="#{pmv.state} - #{pmv.versionName}"></i>
                  <h:outputText styleClass="starts-project-name" value="#{pmv.projectName}" />
                </f:facet>

                <h:panelGroup styleClass="margin-top-10" layout="block" rendered="#{!empty pmv.caseMapStarts}">
                  <b><h:outputText value="Case Map Starts" /></b>
                </h:panelGroup>
                <p:repeat value="#{pmv.caseMapStarts}" var="casemapStart">
                  <p:panel styleClass="start-element" rendered="#{pmv.active}">
                    <p:commandLink action="#{casemapStart.execute}" class="flex-space start-link">
                      <span class="straight-text-icon">
                        <i class="si si-controls-play margin-right-5"></i>
                        <span>#{casemapStart.displayName}</span>
                      </span>
                      <span>#{casemapStart.description}</span>
                    </p:commandLink>
                  </p:panel>
                </p:repeat>

                <h:panelGroup styleClass="margin-top-10" layout="block" rendered="#{!empty pmv.categories}">
                  <b><h:outputText value="Process Starts" /></b>
                </h:panelGroup>
                <p:repeat value="#{pmv.categories}" var="category">
                  <p:outputPanel styleClass="margin-top-10" rendered="#{!empty category.name}">
                    <i class="#{category.cssIcon} table-icon"></i>
                    <span title="#{category.tooltip}">#{category.name}</span>
                  </p:outputPanel>

                  <p:repeat value="#{category.starts}" var="start">
                    <p:panel styleClass="start-element" rendered="#{pmv.active}">
                      <p:commandLink action="#{start.execute}" class="flex-space start-link">
                        <span class="straight-text-icon">
                          <i class="si si-controls-play margin-right-5"></i>
                          <span>#{start.displayName}</span>
                        </span>
                        <span>#{start.description}</span>
                      </p:commandLink>
                    </p:panel>
                  </p:repeat>
                </p:repeat>

              </p:tab>
            </p:accordionPanel>
          </p:panel>
        </h:panelGroup>
      </h:form>
    </ui:define>
  </ui:composition>
</h:body>
</html>
