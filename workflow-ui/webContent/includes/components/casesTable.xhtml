<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:f="http://xmlns.jcp.org/jsf/core"
  xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
  xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:ic="http://ivyteam.ch/jsf/component"
  xmlns:p="http://primefaces.org/ui" xmlns:pe="http://primefaces.org/ui/extensions"
  xmlns:jc="http://java.sun.com/jsf/composite/components">

  <p:dataTable id="cases" var="case" value="#{casesBean.casesDataModel}" widgetVar="casesTable" style="margin-top:10px"
    emptyMessage="No Cases found with given criteria" paginatorPosition="bottom" rows="10" lazy="true" paginator="true"
    rowsPerPageTemplate="10,20,50" paginatorAlwaysVisible="false" sortBy="#{case.startTimestamp}" sortOrder="descending"
    selectionMode="single"
    paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}">
    <p:ajax event="rowSelect" listener="#{casesBean.redirectToCaseRow}" update="@form" />
    <f:facet name="header">
      <p:outputPanel>
        <h:outputText value="Search:" />
        <p:inputText id="casesFilter" onkeyup="PF('casesTable').filter()" style="width:150px"
          placeholder="Enter keyword" value="#{casesBean.casesDataModel.filter}" />
      </p:outputPanel>
    </f:facet>

    <p:column styleClass="icon-row" priority="2">
      <h:outputText id="caseIcon" styleClass="si si-lg si-task-list-approve" />
      <p:tooltip for="caseIcon" value="ID: #{case.id}" position="top" />
    </p:column>

    <p:column filterBy="#{case.state}" styleClass="icon-row" sortBy="#{case.state}">
      <h:outputText id="caseState" styleClass="si si-lg si-#{casesBean.getStateIcon(case.state)}" />
      <p:tooltip for="caseState" value="State: #{case.state}" position="top" />
    </p:column>

    <p:column headerText="Name" filterBy="#{case.getName(case)}" sortBy="#{case.getName(case)}">
      <h:link outcome="caseDetails">
        <f:param name="case" value="#{case.id}" />
        <h:outputText id="caseName" value="#{casesBean.getName(case)}" />
        <p:tooltip for="caseName" value="Case ID: #{case.id}" position="top" />
      </h:link>
    </p:column>

    <p:column headerText="Creator" filterBy="#{case.creatorUserName}" sortBy="#{case.creatorUserName}" priority="2">
      <jc:user user="#{case.creatorUser}" />
    </p:column>

    <p:column headerText="Start" style="text-align: center;" sortBy="#{case.startTimestamp}">
      <jc:datetime id="startTime" datetime="#{case.startTimestamp}" />
    </p:column>

    <p:column headerText="End" style="text-align: center;" sortBy="#{case.endTimestamp}" priority="3">
      <jc:datetime id="endTime" datetime="#{case.endTimestamp}" />
    </p:column>

    <p:column styleClass="icon-row">
      <h:link outcome="caseDetails">
        <f:param name="case" value="#{case.id}" />
        <i class="si si-lg si-information-circle"></i>
      </h:link>
    </p:column>
  </p:dataTable>
</ui:composition>
